<!-- templates/canteen.html -->

<div class="wrapper-canteen tile">
    {% set date_parts = canteen_data.date.split('-') if canteen_data else None %}
    <div class="canteen-header-line">
        <h2 class="canteen-title">{{ canteen_name }}</h2>
        {% if date_parts %}
            <span class="menu-date">Men√º am {{ date_parts[2] }}.{{ date_parts[1] }}.{{ date_parts[0] }}</span>
        {% endif %}
    </div>
    {% if canteen_data %}   
        {% if canteen_data.dishes %}
            {% set excluded_types = [
                "S√º√üspeise",
                "Tagessupe, Brot, Obst",
                "Tagessuppe",
                "Brot",
                "Obst",
                "Dessert (Glas)"
            ] %}
            {% set filtered_dishes = canteen_data.dishes | rejectattr('dish_type', 'in', excluded_types) | list %}
            {% if filtered_dishes %}
                <div class="dish-container">
                    {% for dish in filtered_dishes[:6] %}
                        <div class="dish-box">
                            <span>
                                {% if dish.dish_type == "Pizza" %}üçï
                                {% elif dish.dish_type == "Pasta" %}üçù
                                {% elif dish.dish_type == "Grill" %}üçñ
                                {% elif dish.dish_type == "Studitopf" %}ü•ò
                                {% elif dish.dish_type == "Fisch" %}üêü
                                {% elif dish.dish_type == "Wok" %}ü•°
                                {% elif dish.dish_type == "Fleisch" %}ü•©
                                {% elif dish.dish_type == "Vegetarisch/fleischlos" %}üå±
                                {% else %}{{ dish.dish_type }}
                                {% endif %}
                                
                            </span>
                            <strong class="dish-title">{{ dish.name }}</strong>
    
                            {% if show_prices %}
                                <span class="price-line">
                                    {% set student_price = dish.prices.get('students', {}) %}
                                    {% if student_price.base_price %}
                                        ‚Ç¨{{ '%.2f' | format(student_price.base_price) }}
                                    {% elif student_price.price_per_unit %}
                                        ‚Ç¨{{ '%.2f' | format(student_price.price_per_unit) }} per {{ student_price.unit }}
                                    {% else %}
                                        Not Available
                                    {% endif %}
                                </span>
                            {% endif %}
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <p>No dishes available for today.</p>
            {% endif %}
        {% else %}
            <p>No dishes available for today.</p>
        {% endif %}
    {% else %}
        <h2>{{ error }}</h2>
    {% endif %}
</div>
